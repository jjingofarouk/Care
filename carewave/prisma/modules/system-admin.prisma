enum UserRole {
  ADMIN
  DOCTOR
  NURSE
  PHARMACIST
  RADIOLOGIST
  SOCIAL_WORKER
  PATIENT
  BILLING_OFFICER
  RECEPTIONIST
  LAB_TECHNICIAN
  IT_SUPPORT
}

enum PermissionLevel {
  FULL_ACCESS
  READ_ONLY
  WRITE
  RESTRICTED
}

enum SystemLogType {
  LOGIN
  LOGOUT
  DATA_MODIFICATION
  ERROR
  SECURITY
  SYSTEM_EVENT
}

model User {
  id                    Int                   @id @default(autoincrement())
  uuid                  String                @unique @default(uuid())
  email                 String                @unique
  name                  String
  password              String
  role                  UserRole              @default(PATIENT)
  status                String                @default("ACTIVE")
  departmentId          Int?
  department            Department?           @relation("UserDepartment", fields: [departmentId], references: [id])
  phone                 String?
  address               String?
  profileImage          String?
  lastLogin             DateTime?
  loginAttempts         Int                   @default(0)
  accountLocked         Boolean               @default(false)
  permissions           String?
  createdById           Int?
  createdBy             User?                 @relation("UserCreatedBy", fields: [createdById], references: [id])
  updatedById           Int?
  updatedBy             User?                 @relation("UserUpdatedBy", fields: [createdById], references: [id])
  createdUsers          User[]                @relation("UserCreatedBy")
  updatedUsers          User[]                @relation("UserUpdatedBy")
  payrolls              Payroll[]             @relation("PayrollEmployee")
  cssdLogs              CSSDLog[]             @relation("LoggedBy")
  cssdRequisitions      CSSDRequisition[]     @relation("RequisitionRequestedBy")
  appointmentsBooked    Appointment[]         @relation("AppointmentBookedBy")
  appointmentsCreated   Appointment[]         @relation("AppointmentCreatedBy")
  appointmentsUpdated   Appointment[]         @relation("AppointmentUpdatedBy")
  dispensingRecords     DispensingRecord[]    @relation("DispensedBy")
  refundsProcessed      Refund[]              @relation("RefundProcessedBy")
  refundsApproved       Refund[]              @relation("RefundApprovedBy")
  stockAdjustments      StockAdjustment[]     @relation("AdjustedBy")
  socialServiceCases    SocialServiceCase[]   @relation("SocialWorker")
  radiologyTests        RadiologyTest[]       @relation("Radiologist")
  radiologyTestsCreated RadiologyTest[]       @relation("RadiologyTestCreatedBy")
  radiologyTestsUpdated RadiologyTest[]       @relation("RadiologyTestUpdatedBy")
  radiologyTestsReported RadiologyTest[]      @relation("RadiologyTestReportedBy")
  radiologyCreated      Radiology[]           @relation("RadiologyCreatedBy")
  radiologyUpdated      Radiology[]           @relation("RadiologyUpdatedBy")
  nursingCare           NursingCare[]         @relation("NurseAssigned")
  nursingTasks          NursingTask[]         @relation("TaskAssignedNurse")
  nursingShifts         NursingShift[]        @relation("ShiftNurse")
  surgicalStaff         SurgicalStaff[]       @relation("SurgicalStaff")
  systemLogs            SystemLog[]           @relation("LoggedBy")
  auditLogs             AuditLog[]            @relation("PerformedBy")
  patientRecords        Patient[]             @relation("PatientUser")
  patientCreated        Patient[]             @relation("PatientCreatedBy")
  patientUpdated        Patient[]             @relation("PatientUpdatedBy")
  doctorRecords         Doctor[]              @relation("DoctorUser")
  doctorCreated         Doctor[]              @relation("DoctorCreatedBy")
  doctorUpdated         Doctor[]              @relation("DoctorUpdatedBy")
  dashboardsOwned       Dashboard[]           @relation("DashboardOwner")
  dashboardsCreated     Dashboard[]           @relation("DashboardCreatedBy")
  dashboardsUpdated     Dashboard[]           @relation("DashboardUpdatedBy")
  departmentsHeaded     Department[]          @relation("DepartmentHead")
  createdDepartments    Department[]          @relation("DepartmentCreatedBy")
  updatedDepartments    Department[]          @relation("DepartmentUpdatedBy")
  widgetCreated         DashboardWidget[]     @relation("WidgetCreatedBy")
  widgetUpdated         DashboardWidget[]     @relation("WidgetUpdatedBy")
  systemConfigCreated   SystemConfiguration[] @relation("ConfigCreatedBy")
  systemConfigUpdated   SystemConfiguration[] @relation("ConfigUpdatedBy")
  permissionCreated     RolePermission[]      @relation("PermissionCreatedBy")
  permissionUpdated     RolePermission[]      @relation("PermissionUpdatedBy")
  transactionCreated    Transaction[]         @relation("TransactionCreatedBy")
  transactionApproved   Transaction[]         @relation("TransactionApprovedBy")
  costCenterManaged     CostCenter[]          @relation("CostCenterManager")
  budgetCreated         Budget[]              @relation("BudgetCreatedBy")
  budgetApproved        Budget[]              @relation("BudgetApprovedBy")
  reconciliationCreated  Reconciliation[]      @relation("ReconciliationCreatedBy")
  reconciliationApproved Reconciliation[]      @relation("ReconciliationApprovedBy")
  costAllocationCreated CostAllocation[]      @relation("CostAllocationCreatedBy")
  costAllocationApproved CostAllocation[]     @relation("CostAllocationApprovedBy")
  payrollCreated        Payroll[]             @relation("PayrollCreatedBy")
  payrollApproved       Payroll[]             @relation("PayrollApprovedBy")
  serviceCreated        Service[]             @relation("ServiceCreatedBy")
  serviceUpdated        Service[]             @relation("ServiceUpdatedBy")
  billingCreated        Billing[]             @relation("BillingCreatedBy")
  billingUpdated        Billing[]             @relation("BillingUpdatedBy")
  invoiceCreated        Invoice[]             @relation("InvoiceCreatedBy")
  invoiceUpdated        Invoice[]             @relation("InvoiceUpdatedBy")
  billingItemCreated    BillingItem[]         @relation("BillingItemCreatedBy")
  billingItemUpdated    BillingItem[]         @relation("BillingItemUpdatedBy")
  paymentCreated        Payment[]             @relation("PaymentCreatedBy")
  paymentPlanCreated    PaymentPlan[]         @relation("PaymentPlanCreatedBy")
  paymentPlanApproved   PaymentPlan[]         @relation("PaymentPlanApprovedBy")
  invoiceDocumentUploaded InvoiceDocument[]   @relation("InvoiceDocumentUploadedBy")
  billingNotificationRecipient BillingNotification[] @relation("BillingNotificationRecipient")
  appointmentNotificationRecipient AppointmentNotification[] @relation("NotificationRecipient")
  appointmentDocumentUploaded AppointmentDocument[] @relation("DocumentUploadedBy")
  recurringAppointmentCreated RecurringAppointment[] @relation("RecurringAppointmentCreatedBy")
  recurringAppointmentUpdated RecurringAppointment[] @relation("RecurringAppointmentUpdatedBy")
  doctorAvailabilityCreated DoctorAvailability[] @relation("DoctorAvailabilityCreatedBy")
  doctorAvailabilityUpdated DoctorAvailability[] @relation("DoctorAvailabilityUpdatedBy")
  doctorQualificationCreated DoctorQualification[] @relation("DoctorQualificationCreatedBy")
  doctorQualificationUpdated DoctorQualification[] @relation("DoctorQualificationUpdatedBy")
  doctorNotificationRecipient DoctorNotification[] @relation("DoctorNotificationRecipient")
  medicalRecordCreated  MedicalRecord[]       @relation("MedicalRecordCreatedBy")
  medicalRecordUpdated  MedicalRecord[]       @relation("MedicalRecordUpdatedBy")
  medicalRecordReviewed MedicalRecord[]       @relation("MedicalRecordReviewedBy")
  medicationCreated     Medication[]          @relation("MedicationCreatedBy")
  medicationUpdated     Medication[]          @relation("MedicationUpdatedBy")
  formularyCreated      Formulary[]           @relation("FormularyCreatedBy")
  formularyUpdated      Formulary[]           @relation("FormularyUpdatedBy")
  interactionCreated    DrugInteraction[]     @relation("InteractionCreatedBy")
  interactionUpdated    DrugInteraction[]     @relation("InteractionUpdatedBy")
  adverseReactionCreated AdverseReaction[]    @relation("AdverseReactionCreatedBy")
  adverseReactionUpdated AdverseReaction[]    @relation("AdverseReactionUpdatedBy")
  pharmacyCreated       Pharmacy[]            @relation("PharmacyCreatedBy")
  pharmacyUpdated       Pharmacy[]            @relation("PharmacyUpdatedBy")
  equipmentCreated      RadiologyEquipment[]  @relation("EquipmentCreatedBy")
  equipmentUpdated      RadiologyEquipment[]  @relation("EquipmentUpdatedBy")
  maternityCreated      Maternity[]           @relation("MaternityCreatedBy")
  maternityUpdated      Maternity[]           @relation("MaternityUpdatedBy")
  maternityDocumentUploaded MaternityDocument[] @relation("MaternityDocumentUploadedBy")
  maternityNotificationRecipient MaternityNotification[] @relation("MaternityNotificationRecipient")
  createdAt             DateTime              @default(now())
  updatedAt             DateTime              @updatedAt
}

model SystemConfiguration {
  id                  Int                   @id @default(autoincrement())
  uuid                String                @unique @default(uuid())
  key                 String                @unique
  value               String
  description         String?
  category            String?
  status              String                @default("ACTIVE")
  createdById         Int?
  createdBy           User?                 @relation("ConfigCreatedBy", fields: [createdById], references: [id])
  updatedById         Int?
  updatedBy           User?                 @relation("ConfigUpdatedBy", fields: [updatedById], references: [id])
  auditLogs           AuditLog[]            @relation("SystemConfigAuditLogs")
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt
}

model SystemLog {
  id                  Int                   @id @default(autoincrement())
  uuid                String                @unique @default(uuid())
  userId              Int?
  user                User?                 @relation("LoggedBy", fields: [userId], references: [id])
  type                SystemLogType
  description         String
  ipAddress           String?
  deviceInfo          String?
  module              String?
  action              String
  entityId            Int?
  entityType          String?
  createdAt           DateTime              @default(now())
}

model RolePermission {
  id                  Int                   @id @default(autoincrement())
  uuid                String                @unique @default(uuid())
  role                UserRole
  module              String
  permissionLevel     PermissionLevel
  description         String?
  createdById         Int?
  createdBy           User?                 @relation("PermissionCreatedBy", fields: [createdById], references: [id])
  updatedById         Int?
  updatedBy           User?                 @relation("PermissionUpdatedBy", fields: [updatedById], references: [id])
  auditLogs           AuditLog[]            @relation("RolePermissionAuditLogs")
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt
}

model AuditLog {
  id                  Int                   @id @default(autoincrement())
  uuid                String                @unique @default(uuid())
  action              String
  entity              String
  entityId            Int
  userId              Int?
  user                User?                 @relation("PerformedBy", fields: [userId], references: [id])
  dashboard           Dashboard?            @relation("DashboardAuditLogs", fields: [entityId], references: [id])
  dashboardWidget     DashboardWidget?      @relation("DashboardWidgetAuditLogs", fields: [entityId], references: [id])
  radiology           Radiology?            @relation("RadiologyAuditLogs", fields: [entityId], references: [id])
  radiologyTest       RadiologyTest?        @relation("RadiologyTestAuditLogs", fields: [entityId], references: [id])
  radiologyEquipment  RadiologyEquipment?   @relation("RadiologyEquipmentAuditLogs", fields: [entityId], references: [id])
  systemConfiguration SystemConfiguration?  @relation("SystemConfigAuditLogs", fields: [entityId], references: [id])
  rolePermission      RolePermission?       @relation("RolePermissionAuditLogs", fields: [entityId], references: [id])
  transaction         Transaction?          @relation("TransactionAuditLogs", fields: [entityId], references: [id])
  costCenter          CostCenter?           @relation("CostCenterAuditLogs", fields: [entityId], references: [id])
  budget              Budget?               @relation("BudgetAuditLogs", fields: [entityId], references: [id])
  reconciliation      Reconciliation?       @relation("ReconciliationAuditLogs", fields: [entityId], references: [id])
  bankAccount         BankAccount?          @relation("BankAccountAuditLogs", fields: [entityId], references: [id])
  generalLedger       GeneralLedger?        @relation("GeneralLedgerAuditLogs", fields: [entityId], references: [id])
  taxCategory         TaxCategory?          @relation("TaxCategoryAuditLogs", fields: [entityId], references: [id])
  costAllocation      CostAllocation?       @relation("CostAllocationAuditLogs", fields: [entityId], references: [id])
  payroll             Payroll?              @relation("PayrollAuditLogs", fields: [entityId], references: [id])
  service             Service?              @relation("ServiceAuditLogs", fields: [entityId], references: [id])
  billing             Billing?              @relation("BillingAuditLogs", fields: [entityId], references: [id])
  invoice             Invoice?              @relation("InvoiceAuditLogs", fields: [entityId], references: [id])
  billingItem         BillingItem?          @relation("BillingItemAuditLogs", fields: [entityId], references: [id])
  refund              Refund?               @relation("RefundAuditLogs", fields: [entityId], references: [id])
  payment             Payment?              @relation("PaymentAuditLogs", fields: [entityId], references: [id])
  paymentPlan         PaymentPlan?          @relation("PaymentPlanAuditLogs", fields: [entityId], references: [id])
  invoiceDocument     InvoiceDocument?      @relation("InvoiceDocumentAuditLogs", fields: [entityId], references: [id])
  appointment         Appointment?          @relation("AppointmentAuditLogs", fields: [entityId], references: [id])
  appointmentDocument AppointmentDocument?  @relation("AppointmentDocumentAuditLogs", fields: [entityId], references: [id])
  recurringAppointment RecurringAppointment? @relation("RecurringAppointmentAuditLogs", fields: [entityId], references: [id])
  department          Department?           @relation("DepartmentAuditLogs", fields: [entityId], references: [id])
  doctor              Doctor?               @relation("DoctorAuditLogs", fields: [entityId], references: [id])
  doctorAvailability  DoctorAvailability?   @relation("DoctorAvailabilityAuditLogs", fields: [entityId], references: [id])
  doctorQualification DoctorQualification? @relation("DoctorQualificationAuditLogs", fields: [entityId], references: [id])
  medicalRecord       MedicalRecord?        @relation("MedicalRecordAuditLogs", fields: [entityId], references: [id])
  patient             Patient?              @relation("PatientAuditLogs", fields: [entityId], references: [id])
  medication          Medication?           @relation("MedicationAuditLogs", fields: [entityId], references: [id])
  formulary           Formulary?            @relation("FormularyAuditLogs", fields: [entityId], references: [id])
  drugInteraction     DrugInteraction?      @relation("DrugInteractionAuditLogs", fields: [entityId], references: [id])
  adverseReaction     AdverseReaction?      @relation("AdverseReactionAuditLogs", fields: [entityId], references: [id])
  pharmacy            Pharmacy?             @relation("PharmacyAuditLogs", fields: [entityId], references: [id])
  maternity           Maternity?            @relation("MaternityAuditLogs", fields: [entityId], references: [id])
  maternityDocument   MaternityDocument?    @relation("MaternityDocumentAuditLogs", fields: [entityId], references: [id])
  details             String?
  createdAt           DateTime              @default(now())
}